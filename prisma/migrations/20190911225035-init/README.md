# Migration `20190911225035-init`

This migration has been generated by Andreas MÃ¸ller at 9/11/2019, 10:50:35 PM.
You can check out the [state of the datamodel](./datamodel.prisma) after the migration.

## Database Steps

```sql
CREATE TABLE `reports`.`Node`(`height` int NOT NULL DEFAULT 0 ,`id` varchar(191) NOT NULL  ,`text` varchar(191)   ,`type` varchar(191) NOT NULL DEFAULT '' ,`width` int NOT NULL DEFAULT 0 ,`x` int NOT NULL DEFAULT 0 ,`y` int NOT NULL DEFAULT 0 ,PRIMARY KEY (`id`))
DEFAULT CHARACTER SET utf8mb4 COLLATE utf8mb4_unicode_ci;

CREATE TABLE `reports`.`NodeChart`(`id` varchar(191) NOT NULL  ,`query` varchar(191) NOT NULL DEFAULT '' ,PRIMARY KEY (`id`))
DEFAULT CHARACTER SET utf8mb4 COLLATE utf8mb4_unicode_ci;

CREATE TABLE `reports`.`Report`(`id` varchar(191) NOT NULL  ,`title` varchar(191) NOT NULL DEFAULT '' ,PRIMARY KEY (`id`))
DEFAULT CHARACTER SET utf8mb4 COLLATE utf8mb4_unicode_ci;

CREATE TABLE `reports`.`Slide`(`id` varchar(191) NOT NULL  ,PRIMARY KEY (`id`))
DEFAULT CHARACTER SET utf8mb4 COLLATE utf8mb4_unicode_ci;

CREATE TABLE `reports`.`User`(`createdAt` datetime(3) NOT NULL DEFAULT '1970-01-01 00:00:00' ,`email` varchar(191) NOT NULL DEFAULT '' ,`firstName` varchar(191) NOT NULL DEFAULT '' ,`id` varchar(191) NOT NULL  ,`lastName` varchar(191) NOT NULL DEFAULT '' ,`refreshToken` varchar(191)   ,PRIMARY KEY (`id`))
DEFAULT CHARACTER SET utf8mb4 COLLATE utf8mb4_unicode_ci;

ALTER TABLE `reports`.`Node` ADD COLUMN `chart` varchar(191)  ,
ADD FOREIGN KEY (`chart`) REFERENCES `reports`.`NodeChart`(`id`) ON DELETE SET NULL,ADD COLUMN `slide` varchar(191)  ,
ADD FOREIGN KEY (`slide`) REFERENCES `reports`.`Slide`(`id`) ON DELETE SET NULL;

ALTER TABLE `reports`.`Report` ADD COLUMN `owner` varchar(191)  ,
ADD FOREIGN KEY (`owner`) REFERENCES `reports`.`User`(`id`) ON DELETE SET NULL;

ALTER TABLE `reports`.`Slide` ADD COLUMN `report` varchar(191)  ,
ADD FOREIGN KEY (`report`) REFERENCES `reports`.`Report`(`id`) ON DELETE SET NULL;

CREATE UNIQUE INDEX `User.email` ON `reports`.`User`(`email`)
```

## Changes

```diff
diff --git datamodel.mdl datamodel.mdl
migration ..20190911225035-init
--- datamodel.dml
+++ datamodel.dml
@@ -1,0 +1,49 @@
+datasource db {
+  provider = "mysql"
+  url      = "mysql://root:RVH-DwvtQc2uYu9omd9e@35.228.50.88:3306/reports?sslmode=prefer"
+}
+
+generator photonjs {
+  provider = "photonjs"
+}
+
+model Node {
+  id     String     @default(cuid()) @id
+  chart  NodeChart?
+  height Int
+  slide  Slide?
+  text   String?
+  type   String
+  width  Int
+  x      Int
+  y      Int
+}
+
+model NodeChart {
+  id    String @default(cuid()) @id
+  node  Node[]
+  query String
+}
+
+model Report {
+  id    String  @default(cuid()) @id
+  owner User?
+  slide Slide[]
+  title String
+}
+
+model Slide {
+  id     String  @default(cuid()) @id
+  node   Node[]
+  report Report?
+}
+
+model User {
+  id           String   @default(cuid()) @id
+  createdAt    DateTime @default(now())
+  email        String   @unique
+  firstName    String
+  lastName     String
+  report       Report[]
+  refreshToken String?
+}
```

## Photon Usage

You can use a specific Photon built for this migration (20190911225035-init)
in your `before` or `after` migration script like this:

```ts
import Photon from '@generated/photon/20190911225035-init'

const photon = new Photon()

async function main() {
  const result = await photon.users()
  console.dir(result, { depth: null })
}

main()

```
