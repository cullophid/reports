{"ast":null,"code":"import _objectSpread from \"/Users/andreas/code/reports/app/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/objectSpread\";\nimport _slicedToArray from \"/Users/andreas/code/reports/app/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/slicedToArray\";\nvar _jsxFileName = \"/Users/andreas/code/reports/app/src/components/ReportEditor/TextElement.tsx\";\nimport React, { useState } from \"react\";\nimport styled from \"react-emotion\";\nimport { textElement } from \"../../models/reports\";\nimport * as Theme from \"../../theme\";\nimport TextEditor from \"../TextEditor\";\nimport { DragHandle } from \"../DragHandle\";\nimport { useDrag } from \"../../hooks/mouse\";\nexport var TextElement = function TextElement(props) {\n  var _useState = useState({\n    pressed: null\n  }),\n      _useState2 = _slicedToArray(_useState, 2),\n      state = _useState2[0],\n      setState = _useState2[1];\n\n  var onDragStart = function onDragStart(e) {\n    setState({\n      pressed: {\n        x: e.clientX,\n        y: e.clientY\n      }\n    });\n    props.onClick && props.onClick();\n  };\n\n  var onDrag = function onDrag(e) {\n    var textElement = props.textElement,\n        scale = props.scale,\n        onUpdate = props.onUpdate,\n        edit = props.edit;\n    var pressed = state.pressed;\n    if (!pressed || edit) return;\n    var x = (e.clientX - pressed.x) / scale;\n    var y = (e.clientY - pressed.y) / scale;\n    onUpdate(_objectSpread({}, textElement, {\n      x: textElement.x + x,\n      y: textElement.y + y\n    }));\n    setState({\n      pressed: {\n        x: e.clientX,\n        y: e.clientY\n      }\n    });\n  };\n\n  var onDragEnd = function onDragEnd() {\n    setState({\n      pressed: null\n    });\n  };\n\n  var textElement = props.textElement,\n      scale = props.scale;\n  return React.createElement(BoundingBox, Object.assign({\n    style: {\n      left: textElement.x,\n      top: textElement.y,\n      width: textElement.width,\n      border: props.edit ? \"1px dashed \".concat(Theme.primary) : props.selected ? \"1px solid \".concat(Theme.primary) : \"1px solid transparent\"\n    },\n    key: textElement.id,\n    onDoubleClick: props.onDoubleClick\n  }, useDrag({\n    onDragStart: onDragStart,\n    onDragEnd: onDragEnd,\n    onDrag: onDrag\n  }), {\n    onClick: props.onClick,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 73\n    },\n    __self: this\n  }), props.edit ? React.createElement(Text, {\n    style: {\n      fontSize: textElement.text.fontSize,\n      textAlign: textElement.text.align.toLowerCase()\n    },\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 90\n    },\n    __self: this\n  }, React.createElement(TextEditor, {\n    defaultValue: textElement.text.value,\n    onSave: function onSave(value) {\n      return props.onUpdate(_objectSpread({}, textElement, {\n        text: _objectSpread({}, textElement.text, {\n          value: value\n        })\n      }));\n    },\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 96\n    },\n    __self: this\n  })) : React.createElement(Text, {\n    style: {\n      fontSize: textElement.text.fontSize,\n      textAlign: textElement.text.align.toLowerCase(),\n      border: \"1px solid \".concat(props.selected ? Theme.primary : \"transparent\")\n    },\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 107\n    },\n    __self: this\n  }, textElement.text.value), props.selected && !props.edit && React.createElement(React.Fragment, {\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 120\n    },\n    __self: this\n  }, React.createElement(DragHandle, {\n    onDrag: function onDrag(_ref) {\n      var x = _ref.x,\n          y = _ref.y;\n      props.onUpdate(_objectSpread({}, textElement, {\n        x: textElement.x + x / scale,\n        width: textElement.width - x / scale\n      }));\n    },\n    style: {\n      left: 0,\n      top: \"50%\"\n    },\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 121\n    },\n    __self: this\n  }), React.createElement(DragHandle, {\n    onDrag: function onDrag(_ref2) {\n      var x = _ref2.x;\n      props.onUpdate(_objectSpread({}, textElement, {\n        width: Math.max(1, textElement.width + x / scale)\n      }));\n    },\n    style: {\n      top: \"50%\",\n      right: 0\n    },\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 134\n    },\n    __self: this\n  })));\n};\nvar BoundingBox =\n/*#__PURE__*/\nstyled(\"div\", {\n  label: \"BoundingBox\",\n  target: \"e10ondmu0\"\n})(\"position:absolute;\");\nvar Text =\n/*#__PURE__*/\nstyled(\"div\", {\n  label: \"Text\",\n  target: \"e10ondmu1\"\n})(\"cursor:pointer;margin:0;font-family:\\\"Montserrat\\\",sans-serif;border:1px solid transparent;background:none;border:none;width:100%;min-height:20px;&:focus{outline:none;}\");","map":{"version":3,"sources":["/Users/andreas/code/reports/app/src/components/ReportEditor/TextElement.tsx"],"names":["React","useState","styled","textElement","Theme","TextEditor","DragHandle","useDrag","TextElement","props","pressed","state","setState","onDragStart","e","x","clientX","y","clientY","onClick","onDrag","scale","onUpdate","edit","onDragEnd","left","top","width","border","primary","selected","id","onDoubleClick","fontSize","text","textAlign","align","toLowerCase","value","Math","max","right","BoundingBox","Text"],"mappings":"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","sourcesContent":["import React, { useState, useEffect } from \"react\";\nimport styled from \"react-emotion\";\nimport { textElement } from \"../../models/reports\";\nimport * as Theme from \"../../theme\";\nimport TextEditor from \"../TextEditor\";\nimport { DragHandle } from \"../DragHandle\";\nimport { useDrag } from \"../../hooks/mouse\";\n\ntype pos = {\n  x: number;\n  y: number;\n};\n\ntype BoundingBox = {\n  selected: boolean;\n  edit: boolean;\n  width: number;\n  x: number;\n  y: number;\n};\n\ntype props = {\n  scale: number;\n  textElement: textElement;\n  selected: boolean;\n  edit: boolean;\n  onUpdate: (element: textElement) => void;\n  onClick: () => void;\n  onDoubleClick: () => void;\n};\n\ntype state = {\n  pressed: { x: number; y: number } | null;\n};\n\nexport const TextElement = (props: props) => {\n  const [state, setState] = useState<state>({ pressed: null });\n  const onDragStart = (e: React.MouseEvent<any>) => {\n    setState({\n      pressed: {\n        x: e.clientX,\n        y: e.clientY\n      }\n    });\n    props.onClick && props.onClick();\n  };\n  const onDrag = (e: React.MouseEvent<any>) => {\n    const { textElement, scale, onUpdate, edit } = props;\n    const { pressed } = state;\n\n    if (!pressed || edit) return;\n\n    const x = (e.clientX - pressed.x) / scale;\n    const y = (e.clientY - pressed.y) / scale;\n    onUpdate({\n      ...textElement,\n      x: textElement.x + x,\n      y: textElement.y + y\n    });\n    setState({\n      pressed: {\n        x: e.clientX,\n        y: e.clientY\n      }\n    });\n  };\n  const onDragEnd = () => {\n    setState({ pressed: null });\n  };\n\n  const { textElement, scale } = props;\n  return (\n    <BoundingBox\n      style={{\n        left: textElement.x,\n        top: textElement.y,\n        width: textElement.width,\n        border: props.edit\n          ? `1px dashed ${Theme.primary}`\n          : props.selected\n          ? `1px solid ${Theme.primary}`\n          : \"1px solid transparent\"\n      }}\n      key={textElement.id}\n      onDoubleClick={props.onDoubleClick}\n      {...useDrag({ onDragStart, onDragEnd, onDrag })}\n      onClick={props.onClick}\n    >\n      {props.edit ? (\n        <Text\n          style={{\n            fontSize: textElement.text.fontSize,\n            textAlign: textElement.text.align.toLowerCase() as any\n          }}\n        >\n          <TextEditor\n            defaultValue={textElement.text.value}\n            onSave={(value) =>\n              props.onUpdate({\n                ...textElement,\n                text: { ...textElement.text, value }\n              })\n            }\n          />\n        </Text>\n      ) : (\n        <Text\n          style={{\n            fontSize: textElement.text.fontSize,\n            textAlign: textElement.text.align.toLowerCase() as any,\n            border: `1px solid ${\n              props.selected ? Theme.primary : \"transparent\"\n            }`\n          }}\n        >\n          {textElement.text.value}\n        </Text>\n      )}\n      {props.selected && !props.edit && (\n        <React.Fragment>\n          <DragHandle\n            onDrag={({ x, y }) => {\n              props.onUpdate({\n                ...textElement,\n                x: textElement.x + x / scale,\n                width: textElement.width - x / scale\n              });\n            }}\n            style={{\n              left: 0,\n              top: \"50%\"\n            }}\n          />\n          <DragHandle\n            onDrag={({ x }) => {\n              props.onUpdate({\n                ...textElement,\n                width: Math.max(1, textElement.width + x / scale)\n              });\n            }}\n            style={{\n              top: \"50%\",\n              right: 0\n            }}\n          />\n        </React.Fragment>\n      )}\n    </BoundingBox>\n  );\n};\n\nconst BoundingBox = styled.div`\n  position: absolute;\n`;\n\nconst Text = styled.div`\n  cursor: pointer;\n  margin: 0;\n  font-family: \"Montserrat\", sans-serif;\n  border: 1px solid transparent;\n  background: none;\n  border: none;\n  width: 100%;\n  min-height: 20px;\n  &:focus {\n    outline: none;\n  }\n`;\n"]},"metadata":{},"sourceType":"module"}